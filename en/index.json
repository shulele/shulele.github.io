[{"authors":["LeleShu"],"categories":null,"content":"Lele Shu is a postdoctoral researcher in Department of Land, Air and Water Resources, UC Davis. He obtained PhD degree of Water Resource Engineering and minor degree of Computational Science from Pennsylvania State University in 2017. His research interest includes computational distributed hydrologic model, integrated Coupled Nature-Human System modeling, impact of landuse and climate change and hydrologic data mining.\n","date":1580515200,"expirydate":-62135596800,"kind":"taxonomy","lang":"en","lastmod":1580515200,"objectID":"2525497d367e79493fd32b198b28f040","permalink":"https://www.shulele.net/en/authors/admin/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/en/authors/admin/","section":"authors","summary":"Lele Shu is a postdoctoral researcher in Department of Land, Air and Water Resources, UC Davis. He obtained PhD degree of Water Resource Engineering and minor degree of Computational Science from Pennsylvania State University in 2017. His research interest includes computational distributed hydrologic model, integrated Coupled Nature-Human System modeling, impact of landuse and climate change and hydrologic data mining.","tags":null,"title":"Lele Shu","type":"authors"},{"authors":null,"categories":null,"content":" In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 ","date":1557010800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1557010800,"objectID":"a841ff505ed0b38040ed19872739a8f9","permalink":"https://www.shulele.net/en/class_fdm/class01/class_01/","publishdate":"2019-05-05T00:00:00+01:00","relpermalink":"/en/class_fdm/class01/class_01/","section":"class_FDM","summary":" In this tutorial, I\u0026rsquo;ll share my top 10 tips for getting started with Academic:\nTip 1 ","tags":null,"title":"Class 1 - Overview","type":"docs"},{"authors":["Lele Shu"],"categories":[],"content":" Stop using the offensive virus names Inappropriate naming of the new human disease inevitably causes prejudice and discrimination upon particular people and undue fear of the diseases on global social media, although unintentionally.\nAfter the outbreak of Novel Coronavirus (2019-nCoV) causing a severe respiratory illness, some of the research papers and news on nature (such as Nature 577, 450 (2020), Nature 577, 605-607 (2020), doi: 10.1038/d41586-020-00146-w, doi: 10.1038/d41586-020-00180-8, doi: 10.1038/d41586-020-00253-8 and doi: 10.1038/d41586-020-00262-7 ) and other media used \u0026ldquo;China Coronavirus\u0026rdquo;, \u0026ldquo;Wuhan Coronavirus\u0026rdquo;, even \u0026ldquo;Chinese Virus\u0026rdquo;. Such inappropriate naming did not only lead to affronted counteraction in Chinese social media, but also armed the notorious sinophobia and anti-Asian racism around the world. The people in the region suffering short-term contagious virus now will be stigmatized by far-reaching hostility from outside.\nI propose the editors, journalists and researchers on nature and broad science community to avoid such inappropriate names of any current and future human infectious diseases or viruses. Even though it is difficult and time-consuming to rename the diseases and viruses we named before, such as Middle East Respiratory Syndrome (MERS-CoV), Spanish flu, Ebola Virus, we must take immediate action of adapting no-harm names.\nIn 2015, for minimizing \u0026ldquo;unnecessary negative impact of disease names on trade, travel, tourism or animal welfare, and avoid causing offense to any cultural, social, national, regional, professional or ethnic groups\u0026rdquo;, the World Health Organization (WHO) issued guidelines that suggested scientists, journalist and health officials to use more neutral, generic terms to name new human diseases. The guideline is applicable to any unrecognized infections, syndromes, viruses, and diseases of humans that unreported in human and harm human health potentially.\nIn scientific communities, such as The Lancet and The New England Journal of Medicine, the \u0026ldquo;2019 novel coronavirus\u0026rdquo; is referenced dominantly, which is the no-harm name describing the 2019-nCoV. As the names of the new diseases and viruses will make their way into human history, we must select the more neutral and non-offensive names methodically.\nAfter one week, I got reply:\n Thank you for your submission to Correspondence. We have received a large number of letters relating to the new coronavirus, many of which make overlapping points or points already covered by our reporters. We have therefore chosen a representative sample for publication.\n The wrong names are still on Nature.com, I will continue doing my best to let them correct them.\n","date":1580515200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1580515200,"objectID":"1060975cb180db69a40d839506ce1c52","permalink":"https://www.shulele.net/en/post/20200201_nature/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/en/post/20200201_nature/","section":"post","summary":"Stop using the offensive virus names Inappropriate naming of the new human disease inevitably causes prejudice and discrimination upon particular people and undue fear of the diseases on global social media, although unintentionally.\nAfter the outbreak of Novel Coronavirus (2019-nCoV) causing a severe respiratory illness, some of the research papers and news on nature (such as Nature 577, 450 (2020), Nature 577, 605-607 (2020), doi: 10.1038/d41586-020-00146-w, doi: 10.1038/d41586-020-00180-8, doi: 10.","tags":[],"title":"Leter to Nature: Stop using the offensive virus names","type":"post"},{"authors":["Lele Shu"],"categories":[],"content":"Is the current calendar is the best or only way to represent days?\nThe days we experienced, undergoing, and expecting are recorded a piece of paper; we call it a calendar, where marks days of years, months, weeks, and holidays. The current calendar appearance that organized with month and weeks are very efficient to display the days of week and month.\nBut, the calendar drops the original meaning of \u0026ldquo;Month\u0026rdquo;, which was related to the moon and moon phase, while the lunar calendar and lunisolar calendar (such as Chinese Calendar) still conserve the sense in the month. The month is defined according to the moon phase.\nOne month is defined from a black moon to the next black moon, as a lunar month. Since the Synodic period is ~29.5 days, some months have 29 and the others have 30 days. Winter(northern sphere) has more 29-day months, while summer has more 30-day month, because of the orbit speed of the earth.\nAnother problem with the mismatch of the lunar month is the number of days in a solar year. We have to find the common multiple between the moon synodic period and the orbital period of the earth. The days of a solar year is 365.25 days, but the number of days in 12 lunar months is ~355 days. The pure lunar calendar simply ignores the difference, so that the number of years is different from solar and lunar years. The Chinese calendar, which is a lunisolar calendar, solves the problem with leap months. Seven leap months are inserted in every 19 years, such that days in 19 Chinese years are the same as 19 Julian or solar years.\nAbove is the background.\nI want to have a calendar that shows date, days of weeks and the moon phases together, and that represents the endless of time. Here is the calendar:\n","date":1578657938,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1579651200,"objectID":"ee213745a24299679c6c60e28701cfcb","permalink":"https://www.shulele.net/en/post/20200110_calender/","publishdate":"2020-01-10T12:05:38Z","relpermalink":"/en/post/20200110_calender/","section":"post","summary":"Is the current calendar is the best or only way to represent days?\nThe days we experienced, undergoing, and expecting are recorded a piece of paper; we call it a calendar, where marks days of years, months, weeks, and holidays. The current calendar appearance that organized with month and weeks are very efficient to display the days of week and month.\nBut, the calendar drops the original meaning of \u0026ldquo;Month\u0026rdquo;, which was related to the moon and moon phase, while the lunar calendar and lunisolar calendar (such as Chinese Calendar) still conserve the sense in the month.","tags":[],"title":"Spiral calendar","type":"post"},{"authors":["Shu, Lele","Ullrich, Paul","Duffy, Christopher"],"categories":null,"content":"Hydrological modeling is an essential strategy for understanding natural flows, particularly where observations are lacking in either space or time, or where topographic roughness leads to a disconnect in the characteristic timescales of overland and groundwater flow. Consequently, significant opportunities remain for the development of extensible modeling systems that operate robustly across regions. Towards the development of such a robust hydrological modeling system, this paper introduces the Solver for Hydrological Unstructured Domain (SHUD), an integrated multi-process, multi-scale, multi-timestep hydrological model, in which hydrological processes are fully coupled using the semi-discrete Finite Volume Method. The SHUD integrates overland flow, snow accumulation/melting, evapotranspiration, subsurface and groundwater flow, and river routing, while realistically capturing the physical processes in a watershed.\nThe SHUD incorporates one-dimension unsaturated flow, two-dimension groundwater flow, and river channels connected with hillslopes via overland flow and baseflow.\nThis paper introduces the design of SHUD, from the conceptual and mathematical description of hydrological processes in a watershed to computational structures. To demonstrate and validate the model performance, we employ three hydrological experiments: the V-Catchment experiment, Vauclin\u0026rsquo;s experiment, and a study of the Cache Creek Watershed in northern California, USA.\nPossible applications of then SHUD model include hydrological studies from the hillslope scale to regional scale, water resource and stormwater management, and coupling research with related fields such as limnology, agriculture, geochemistry, geomorphology, water quality, and ecology, climatic and landuse change. In general, SHUD is a valuable scientific tool for any modeling task involving simulating and understanding hydrological response.\n","date":1574668800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1574668800,"objectID":"dd327aec1c211f77164ab6dc21c484bf","permalink":"https://www.shulele.net/en/publication/shu2019_shud/","publishdate":"2019-11-25T00:00:00-08:00","relpermalink":"/en/publication/shu2019_shud/","section":"publication","summary":"This paper introduces the design of SHUD, from the conceptual and mathematical description of hydrological processes in a watershed to computational structures. To demonstrate and validate the model performance, we employ three hydrological experiments: the V-Catchment experiment, Vauclin's experiment, and a study of the Cache Creek Watershed in northern California, USA.","tags":[],"title":"Solver for Hydrologic Unstructured Domain (SHUD): Numerical modeling of watershed hydrology with the finite element method","type":"publication"},{"authors":["Lele Shu"],"categories":[],"content":" SUNDIALS: SUite of Nonlinear and DIfferential/ALgebraic Equation Solvers SUNDIALS (https://computing.llnl.gov/projects/sundials) is a very powerful mathematical library that is helpful in solving engineering and scientific problems efficiently. CVODE is one of the tools, aiming to solve Ordinary Differential Equation, in C language. In the Solver of Hydrologic Unstructured Domain (SHUD) model, the system of ODEs describing the hydrological processes is fully coupled and solved simultaneously at each time step ($ \\Delta t=t{n}-t{n-1}$) using CVODE, a stiff solver based on Newton-Krylov iteration.\nThe latest version of SUNDIALS is v5.0.0, released on November 2019. Let\u0026rsquo;s install it on a Mac OS or Linux system.\nI test the installation on Mac 10.13 and Ubuntu 18.04.3 LTS (GNU/Linux 4.15.0-66-generic x86_64)\n Download SUNDIALS, via https://computing.llnl.gov/projects/sundials/sundials-software. Or get latest SUNDIALS on GitHub:\ngit clone https://github.com/LLNL/sundials.git   Now, you must have the source code of SUNDIALS in your folder. Please enter the folder. Let\u0026rsquo;s assume you are in the same level of sundials.\n Create a install folder.  The installation folder names installSundials\n mkdir installSundials cd installSundials rm -rf builddir instdir srcdir mkdir builddir mkdir instdir mkdir srcdir cd builddir/   Configure the installation with CCMAKE.  There are two ways to configure the installation. One is GUI, and the other is command line.\n Option 1, type command blow:\nccmake ../../sundials/   You will see a screen like this: Use your cursor, move to line CMAKE_INSTALL_PREFIX, which is the path SUNDIALS will be installed. Press Enter to start edit the line. I install it on /usr/local/sundials\nAnother path you may change is the path of example code, EXAMPLES_INSTALL_PATH.\nNext, you need to select which solver you want to install, such as, ARKODE, CVODE, CVODES IDA, IDAS, KINSOL. They are on the top of your GUI; press Enter to enable or disable it. Since I need the CVODE only, I turn the BUILD_CVODE option ON and keep the rest of them OFF.\nIf you have OpenMP on your machine and you need the support of OpenMP parallel in your program, you can turn the OPENMP_ENABLE ON.\nAfter edits, press C to configure, and press C again, when g option shows up on the bottom, press g to generate configuration files.\n Option 2, you can use command to realise the edits above, for example:\ncmake -DCMAKE_INSTALL_PREFIX=/usr/local/sundials \\ -DEXAMPLES_INSTALL_PATH=../example \\ -DBUILD_CVODE=ON \\ -DBUILD_CVODES=OFF \\ -DBUILD_ARKODE=OFF \\ -DBUILD_CVODES=OFF \\ -DBUILD_IDA=OFF \\ -DBUILD_IDAS=OFF \\ -DBUILD_KINSOL=OFF \\ -DOPENMP_ENABLE=ON \\ ../../sundials/   The command above configure installation, to install SUNDIALS to /usr/local/sundials, the examples to ../example, install CVODE only, with OpenMP support.\nIf you don\u0026rsquo;t need OpenMP or your OpenMP may result in errors, use the command below:\n cmake -DCMAKE_INSTALL_PREFIX=/usr/local/sundials \\ -DEXAMPLES_INSTALL_PATH=../example \\ -DBUILD_CVODE=ON \\ -DBUILD_CVODES=OFF \\ -DBUILD_ARKODE=OFF \\ -DBUILD_CVODES=OFF \\ -DBUILD_IDA=OFF \\ -DBUILD_IDAS=OFF \\ -DBUILD_KINSOL=OFF \\ -DOPENMP_ENABLE=OFF \\ ../../sundials/   make and install  This is simple and easy, run:\n make make install  Sometimes, if the system may require higher previlage. If so, please try to use sudo:\n make sudo make install  If there is no error occur, the SUNDIALS is installed successfully. Congrats.\n Test the SUNDIALS library with the examples.  Enter the example folder, ../example as the Option 2 in step 3. You will see several examples. Use make to compile all of them:\n cd ../example/cvode/serial/ ls make  After make, you will see files like this:\n Test the program:\n./cvAdvDiff_bnd ./cvKrylovDemo_ls   Now, you can use SUNDIALS/CVODE in your own numeric solver.\nBe patient, you will meet more challenges.\n","date":1574201138,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1567641600,"objectID":"3a75dfb2481ee41786d8cb0dff7b0c33","permalink":"https://www.shulele.net/en/post/20191119_sundials/","publishdate":"2019-11-19T22:05:38Z","relpermalink":"/en/post/20191119_sundials/","section":"post","summary":"SUNDIALS: SUite of Nonlinear and DIfferential/ALgebraic Equation Solvers SUNDIALS (https://computing.llnl.gov/projects/sundials) is a very powerful mathematical library that is helpful in solving engineering and scientific problems efficiently. CVODE is one of the tools, aiming to solve Ordinary Differential Equation, in C language. In the Solver of Hydrologic Unstructured Domain (SHUD) model, the system of ODEs describing the hydrological processes is fully coupled and solved simultaneously at each time step ($ \\Delta t=t{n}-t{n-1}$) using CVODE, a stiff solver based on Newton-Krylov iteration.","tags":[],"title":"How to Install Sundials 5.x or Cvode on Mac Linux System","type":"post"},{"authors":["Lele Shu"],"categories":["Research"],"content":" This project is the hydrologic modeling part of the project Model Integration through Knowledge-Rich Data and Process Composition.\nIntroduction of project \n   Overview of the use of artificial intelligence techniques to support model integration   Tasks in hydrologic modeling    The completed workflow of hydrologic modeling with PIHM model and national/global data services.      Animation of flood plant in South Sudan from 2001 to 2017 based on FLDAS data.      Elevation and PIHM mesh of the Pongo watershed in South Sudan   Accomplishment of the project keep updating\n","date":1572912000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1572912000,"objectID":"96fa197399a26c7c4c95df4e2a938cf5","permalink":"https://www.shulele.net/en/project/mint/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/en/project/mint/","section":"project","summary":"This project is the hydrologic modeling part of the project Model Integration through Knowledge-Rich Data and Process Composition.\nIntroduction of project \n   Overview of the use of artificial intelligence techniques to support model integration   Tasks in hydrologic modeling    The completed workflow of hydrologic modeling with PIHM model and national/global data services.      Animation of flood plant in South Sudan from 2001 to 2017 based on FLDAS data.","tags":["PIHM","Watershed","Automatic modeling","Hydrology","Drought","Flood","Climate change","Landuse change"],"title":"Automatic hydrologic deployment and modeling","type":"project"},{"authors":["Lele Shu"],"categories":[],"content":" This script is to demonstrate the capability and scheme to realise the animation. You have to prepare your own data for this animation script.\nScript for Global NDVI rm(list=ls()) library(RoundAndRound) # devtools::install_github('shulele/RoundAndRound') col.fun=function(x){ colorspace::terrain_hcl(x, l=c(65,95), power=c(1/3, 1.5)) } plotStar \u0026lt;- function(x, y, radius, angle=180, xyratio=1, ...){ i \u0026lt;- 1:11 alpha \u0026lt;- 2*pi / 10 r \u0026lt;- radius * (i %% 2 + 1)/2 omega \u0026lt;- alpha * i + angle * pi /180 invisible(mapply(function(a, b, ...) polygon(r*sin(omega) + a, r*cos(omega) * xyratio + b, ...), x, y, ...)) } # setwd(\u0026quot;~/Dropbox/文章天下事/Drafts/2018-CAWildfireMap/Rcode\u0026quot;) #install.packages('ncdf4') clib=c('ncdf4', 'raster','rgeos','rgdal','ggplot2', 'lattice') tmp=lapply(clib, library, character.only=T) key='NDVI_GLOBAL' cn=FALSE # cn=TRUE if(cn){dir.gif = file.path('../gif', paste0(key, '_cn') )}else{ dir.gif = file.path('../gif', paste0(key, '_en') )} dir.in = file.path('/Volumes/WD8T/FireIndex/RDS/NDVI') dir.fig = file.path('../figure', key) dir.rds = file.path('../RDS', key) dlist = list(dir.in, dir.fig, dir.gif, dir.rds); tmp=lapply(dlist, dir.create, showWarnings = F, recursive = T) crs0=crs('+init=epsg:4326') rds.riv = '/Users/leleshu/Dropbox/PIHM/Projects/CommonData/Global/ne_10m_rivers_lake_centerlines_scale_rank/ne_10m_rivers_lake_centerlines_scale_rank.RDS' sp.riv = readRDS( file =rds.riv) map=readRDS('/Users/leleshu/Dropbox/PIHM/Projects/CommonData/Global/ADM/cntry02.RDS') sp.prov = map # map=gUnaryUnion(map) crs(map)= CRS('+init=epsg:4326') brk = sort(unique(c(-1, 0.2, seq(2 ,10, by = 1)/10) )) brk = seq(0, 10, 1)/10 # cols=rev(colorspace::diverge_hsv(length(brk) ) ) cols=rev(col.fun(length(brk))); ncols = length(cols) pngout\u0026lt;-function(fn, wd = 12, ht = 8){ png(fn, width=wd, height=ht, unit='in', res=150) } # years = 2010:2017; years = 2002:2009; ny=length(years) # plot(map, axes=T) # plotclock(time=c(1,NA,NA), add=T, orig=orig, rad=4, val=month.abb, ab=1.2) if(cn){ labs=c('1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月') }else{ labs=month.abb } # # library(foreach) # library(doMC) # library(doParallel) # registerDoMC(6) # plot(r) xp=c(-180, 180, 180, -180) yp=c(-90, -90, 90,90) xt=seq(-180, 180, 30) yt=seq(-90, 90, 30) xtlab= rep('W', length(xt)); xtlab[xt\u0026gt;0]='E'; xtlab[xt==0]='';xtlab=paste0('°', xtlab) ytlab= rep('S', length(xt)); xtlab[xt\u0026gt;0]='N'; xtlab[xt==0]='';ytlab=paste0('°', ytlab) rcl=rbind(c(-1000, 0, 0), c(1, 10, 1) ) mygrid \u0026lt;- function(h=NULL, v=NULL, lty=2, col='gray80', ...){ fun.h=function(x){ abline(h=x, lty=lty, col=col, ...) } fun.v=function(x){ abline(v=x, lty=lty, col=col, ...) } if(!is.null(h)) tmp = lapply(h, fun.h) if(!is.null(v)) tmp = lapply(v, fun.v) } theta=1:360-90 - 360/12 cc.cols=col.fun(180) cc.cols=c(cc.cols, rev(cc.cols)) cc=PCS2CCS(theta=theta, a=0.8) ext=extent(map) # x= foreach (iy = 1:ny) %dopar%{ for(iy in 1:ny){ yr= years[iy] fn.in = file.path(dir.in, paste0('NDVI',yr,'.RDS')) message(iy,'/', ny, '\\t',yr, '\\t', fn.in) dat = readRDS(fn.in) tag = substr(names(dat), 2, nchar(names(dat)) ) nmon = length(tag) for(i in 1:nmon){ rx=dat[[i]] r=reclassify(rx, rcl) message(i,'/', nmon, '\\t', tag[i] ) ttl = paste0(substr(tag[i], 1,4), '.', substr(tag[i], 5,6) ) pngout(file.path(dir.gif, paste0(key, tag[i], '.png')), ht=6, wd=10) par(mar=c(2.5,2.5,1,1)) # plot(map, axes=T) # plot(map, col='white', axes=T, border='transparent') plot(xp, yp, type='n', axes=F, asp=1, xlim = range(xp), ylim=range(yp)); box(); axis(side=1, at=xt); axis(side=2, at=yt) polygon(xp,yp, border='lightskyblue', col='lightskyblue') plot(add=T, map, col='white', axes=T, border='transparent') mygrid(h=yt, v=xt) plot(add=T, r, breaks=brk, col=cols, legend=FALSE, axes=F); mtext(ttl, side=3, cex=2.5, line=-2, font=2, col='darkgreen') plot(add=T, sp.riv, col=rgb(0,0,1, 0.3), lwd=.5) mygrid(h=yt, v=xt) par(fig=c(c(0.1, 0.3)+.0, c(0.1,0.24)+.16), new=T, mar=c(0,0,0,0)) tmp=density(r, plot=F) plot(tmp$x, tmp$y, type='l', lwd=3, bg='gray80', col=3, axes=F, xlim=c(0,1), ylim=c(-1,4.5)) plot(r, legend.only=TRUE, breaks=brk, col=cols, smallplot=c(.0, 1, .0, .13), legend.width=5, legend.shrink=.7, cex=5, horizontal=T, axis.args=list(col.axis='blue', lwd = 0, font.axis=1, cex.axis=1, tck = 0, line=-.85, labels=brk, cex.axis=1.2), legend.args=list(text='',col=4, side=3, font=1, cex=1.5) ) x.mon=as.numeric(substr(tag[i], 5,6)) if(cn){ par(fig=c(c(0.3, 0.55)+.28, c(0.6,0.86)+.05), new=T, mar=c(0,0,0,0) ,family='STKaiti') }else{ par(fig=c(c(0.3, 0.55)+.28, c(0.6,0.86)-.4), new=T, mar=c(0,0,0,0) ) } plot(0, type='n', axes=F, xlab='', ylab='', xlim=c(-1,1)*1.5, ylim=c(-1,1)*1.5, asp=1) plotclock(time=c(x.mon,NA,NA),rad=1.1, val=labs, axes=F, add=T, fun.plot = polygon, val.arg = list(col=4, cex=.95)) # color ring. points(cc, col=cc.cols, cex=1.4, pch=19) dev.off() # stop('stop') } } fps=6 fn.mov = file.path(dirname(dir.gif), paste0(key,'_', fps,'fps.mp4') ) cmd = paste('ffmpeg -r ', fps, '-f image2 -s 1920x1080 -i ', paste0(dir.gif, '/*.png'), '-vcodec libx264 -crf 25 -pix_fmt yuv420p', fn.mov) print(cmd) # system(cmd)  Script for China NDVI rm(list=ls()) # devtools::install_github('shulele/RoundAndRound') library(RoundAndRound) library(xts) col.fun=function(x){ colorspace::terrain_hcl(x, l=c(65,95), power=c(1/3, 1.5)) } plotStar \u0026lt;- function(x, y, radius, angle=180, xyratio=1, ...){ i \u0026lt;- 1:11 alpha \u0026lt;- 2*pi / 10 r \u0026lt;- radius * (i %% 2 + 1)/2 omega \u0026lt;- alpha * i + angle * pi /180 invisible(mapply(function(a, b, ...) polygon(r*sin(omega) + a, r*cos(omega) * xyratio + b, ...), x, y, ...)) } #install.packages('ncdf4') clib=c('ncdf4', 'raster','rgeos','rgdal','ggplot2', 'lattice') tmp=lapply(clib, library, character.only=T) key='NDVI_CN' # cn=FALSE cn=TRUE if(cn){ dir.gif = file.path('../gif', paste0(key, '_cn') ) }else{ dir.gif = file.path('../gif', paste0(key, '_en') ) } dir.in = file.path('../RDS/NDVI_CN/') dir.fig = file.path('../figure', key) dir.rds = file.path('../RDS', key) dlist = list(dir.in, dir.fig, dir.gif, dir.rds); tmp=lapply(dlist, dir.create, showWarnings = F, recursive = T) crs0=crs('+init=epsg:4326') sp.prov = readRDS( file = file.path(dir.rds, 'province.RDS')) sp.cn=readRDS(file = file.path(dir.rds, 'map.RDS')) sp.city = readRDS( file = file.path(dir.rds, 'city.RDS')) sp.riv = readRDS( file = file.path(dir.rds, 'riv.RDS')) # map=readRDS('../RDS/CONUS.RDS') ext=extent(sp.cn) ia=gArea(sp.cn, byid = T) id=order(ia, decreasing = T)[1:6] map=sp.cn[id, ] map@data=data.frame(1:6) crs(map)= CRS('+init=epsg:4326') brk = sort(unique(c(-1, 0.2, seq(2 ,10, by = 1)/10) )) brk = seq(0, 10, 1)/10 # cols=rev(colorspace::diverge_hsv(length(brk) ) ) cols=rev(col.fun(length(brk))); ncols = length(cols) pngout\u0026lt;-function(fn, wd = 12, ht = 8){ png(fn, width=wd, height=ht, unit='in', res=150) } years = 2010:2017; years = 2002:2017; ny=length(years) # plot(map, axes=T) # plotclock(time=c(1,NA,NA), add=T, orig=orig, rad=4, val=month.abb, ab=1.2) if(cn){ labs=c('1月','2月','3月','4月','5月','6月','7月','8月','9月','10月','11月','12月') }else{ labs=month.abb } # # library(foreach) # library(doMC) # library(doParallel) # registerDoMC(6) # plot(r) iy=1 rid1=which(as.numeric(sp.riv@data$JB) ==1) rid2=which(as.numeric(sp.riv@data$JB) ==2) ct.xy=coordinates(sp.city) ct.txt=as.character(sp.city@data$PINYIN) theta=1:360-90 - 360/12 cc.cols=col.fun(180) cc.cols=c(cc.cols, rev(cc.cols)) cc=PCS2CCS(theta=theta, a=0.8) go\u0026lt;-function(){ tsd=readRDS(file.path(dir.rds, paste0(key,'.TSD.RDS')) ) tsd=cbind(tsd, movingFun(tsd, 12)) txx=coredata(tsd) xt=seq(min(years), max(years), length.out = 12*(diff(range(years))+1) ) mat=cbind(xt, txx) } tsd=go() # x= foreach (iy = 1:ny) %dopar%{ for(iy in 1:ny){ yr= years[iy] fn.in = file.path(dir.in, paste0('NDVI',yr,'.RDS')) message(iy,'/', ny, '\\t',yr, '\\t', fn.in) dat = readRDS(fn.in) tag = substr(names(dat), 2, nchar(names(dat)) ) nmon = length(tag) for(i in 1:nmon){ rx=dat[[i]] r=mask(rx, map) # r=rx message(i,'/', nmon, '\\t', tag[i] ) ttl = paste0(substr(tag[i], 1,4), '.', substr(tag[i], 5,6) ) graphics.off() pngout(file.path(dir.gif, paste0(key, tag[i], '.png')), ht=7, wd=10) par(mar=c(2.5,2.5,1,1)) # plot(map, axes=T) plot(map, border='gray80', axes=T, ylim=c(19, 53), xlim=c(74, 135)) r[r\u0026lt;0]=0 r[r\u0026gt;1]=1 plot(add=T, r, breaks=brk, col=cols, legend=FALSE); mtext(ttl, side=3, cex=2.5, line=-2, adj=1, font=2, col='darkgreen') plot(map, add=T, border = 4, lwd=.7, lty=2) plot(add=T, sp.prov, border='gray50', lwd=.7, lty=2) plot(add=T, sp.riv[rid1, ], col=rgb(0,0,1, 0.6), lwd=1.5) plot(add=T, sp.riv[rid2, ], col=rgb(0,0,1, 0.6), lwd=.8) plot(add=T, sp.city, pch=20, col='darkgreen') plotStar(ct.xy[1,1], ct.xy[1,2], .5, pch=3, col=2) # text(ct.xy, ct.txt, cex=.5) grid() # xloc=c(0.05, 0.3); yloc=c(0.1,0.13) # plot(r, legend.only=TRUE, breaks=brk, col=cols, # smallplot=c(xloc+.03, yloc+.02), # legend.width=5, legend.shrink=.7, cex=5, horizontal=T, # axis.args=list(col.axis='blue', lwd = 0, # font.axis=4, cex.axis=1.5,tck = 0, line=-.85, # labels=brk, cex.axis=1.2), # legend.args=list(text='',col=4, side=3, font=2, cex=1.5) # ) # dev.off();plot(r) par(fig=c(c(0.04, 0.305)+.04, c(0.1,0.24)+.03), new=T, mar=c(0,0,0,0)) tmp=density(r, plot=F) plot(tmp$x, tmp$y, type='l', axes=F, lwd=2, bg='gray80', col=3, xlim=c(0,1), ylim=c(-1,4.5)) plot(r, legend.only=TRUE, breaks=brk, col=cols, smallplot=c(.0, 1, .0, .13), legend.width=5, legend.shrink=.7, cex=5, horizontal=T, axis.args=list(col.axis='blue', lwd = 0, font.axis=1, cex.axis=1, tck = 0, line=-.85, labels=brk, cex.axis=1.2), legend.args=list(text='',col=4, side=3, font=1, cex=1.5) ) x.mon=as.numeric(substr(tag[i], 5,6)) if(cn){ par(fig=c(c(0.3, 0.55)+.1, c(0.6,0.85)+.05), new=T, mar=c(0,0,0,0), family='STKaiti') }else{ par(fig=c(c(0.3, 0.55)+.1, c(0.6,0.85)+.05), new=T, mar=c(0,0,0,0)) } plot(0, type='n', axes=F, xlab='', ylab='', xlim=c(-1,1)*1.5, ylim=c(-1,1)*1.5, asp=1) plotclock(time=c(x.mon,NA,NA),rad=1, val=labs, axes=F, add=T, fun.plot = polygon, val.arg = list(col=4, cex=.95)) # color ring. points(cc, col=cc.cols, cex=1.4, pch=19) # text(0, 0, ttl, col='gray', cex=1.2) text(0, 0, years[iy], col='darkgreen', cex=1.5) text(0, -0.4, \u0026quot;Lele Shu\u0026quot;, col='gray40', cex=.7, font=2, family='Kaiti SC') # South Sea par(fig=c(c(0.7, 0.9)+.08, c(0.1,0.4)-.029), new=T, mar=c(0,0,0,0)) plot(sp.cn, type='n', axes=F, xlab='', ylab='', xlim=c(105,125), ylim=c(6,20)) plot(add=T, sp.riv[c(rid1,rid2), ], col=rgb(0,0,1, 0.6), lwd=1) box(lty='solid'); grid() axis(side=3, cex.axis=.5, tick=NULL, lwd=0, line=-1, font=2) axis(side=2, cex.axis=.5, tick=NULL, lwd=0, line=-1, font=2) plot(add=T, r, breaks=brk, col=cols, legend=FALSE); # TREND par(fig=c(c(0.04, 0.4)+.04, c(0.1,0.2)+.75), mgp = c(0, 1, 0), new=T, mar=c(0,0,0,0)) matplot(tsd[,1], tsd[,-1], xlab='', ylab='', type='l', axes=F, col=c('darkgreen', 'red'), lwd=c(1,2), lty=1); axis(side=1, at=years, cex.axis=.7, font.axis=4) tid=i+(iy-1)*12 points(tsd[tid, 1], tsd[tid, 2], pch=20, col='darkgreen', cex=2); mtext(side=2, 'Mean') dev.off() # stop('stop') } } fps=6 fn.mov = file.path(dirname(dir.gif), paste0(key,'_', fps,'fps.mp4') ) cmd = paste('ffmpeg -r ', fps, '-f image2 -s 1920x1080 -i ', paste0(\u0026quot;'\u0026quot;, dir.gif, '/*.png', \u0026quot;'\u0026quot;), '-vcodec libx264 -crf 25 -pix_fmt yuv420p', fn.mov) print(cmd) system(cmd)  ","date":1570061707,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1567641600,"objectID":"a4b7efe1fd1c43e15be015fa48032888","permalink":"https://www.shulele.net/en/post/20191003_r_animation/","publishdate":"2019-10-03T00:15:07Z","relpermalink":"/en/post/20191003_r_animation/","section":"post","summary":"This script is to demonstrate the capability and scheme to realise the animation. You have to prepare your own data for this animation script. Script for Global NDVI rm(list=ls()) library(RoundAndRound) # devtools::install_github('shulele/RoundAndRound') col.fun=function(x){ colorspace::terrain_hcl(x, l=c(65,95), power=c(1/3, 1.5)) } plotStar \u0026lt;- function(x, y, radius, angle=180, xyratio=1, ...){ i \u0026lt;- 1:11 alpha \u0026lt;- 2*pi / 10 r \u0026lt;- radius * (i %% 2 + 1)/2 omega \u0026lt;- alpha * i + angle","tags":[],"title":"R Script to Animate Global NDVI","type":"post"},{"authors":["Ward, Nicole K.","Fitchett, Leah","Hart, Julia A.","Shu, Lele","et. al"],"categories":null,"content":"","date":1564038000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1564038000,"objectID":"9966a86567302d209bdcd768044bcf9d","permalink":"https://www.shulele.net/en/publication/ward2018/","publishdate":"2019-07-25T00:00:00-07:00","relpermalink":"/en/publication/ward2018/","section":"publication","summary":"Integrated modeling is a critical tool to evaluate the behavior of coupled human–freshwater systems. However, models that do not consider both fast and slow processes may not accurately reflect the feedbacks that define complex systems. We evaluated current coupled human–freshwater system modeling approaches in the literature with a focus on categorizing feedback loops as including economic and/or socio-cultural processes and identifying the simulation of fast and slow processes in human and biophysical systems. Fast human and fast biophysical processes are well represented in the literature, but very few studies incorporate slow human and slow biophysical system processes. Challenges in simulating coupled human–freshwater systems can be overcome by quantifying various monetary and non-monetary ecosystem values and by using data aggregation techniques. Studies that incorporate both fast and slow processes have the potential to improve complex system understanding and inform more sustainable decision-making that targets effective leverage points for system change.","tags":[],"title":"Integrating fast and slow processes is essential for simulating human–freshwater interactions","type":"publication"},{"authors":["Lele Shu"],"categories":[],"content":" The normalized difference vegetation index (NDVI) is a simple graphical indicator that reflect the greenness and the heath condition of vegetations.\nThe raw data is from NASA MOD13A.\n The global NDVI variation from 2002 to 2017.     The NDVI varies from 2002 to 2017 in US (Continental)   How to download the rawdata The code of the monthly NDVI from MODIS dataset is MOD13C2, so type the code below in your terminal and the wget will download all availalble data from server to you local matchine.\nwget --user=XXXXX --password=XXXX -r -c -np -x https://e4ftl01.cr.usgs.gov/MOLT/MOD13C2.006/   The R package RoundAndRound and PIHMgisR is used for this data processing and visulization.\n","date":1561593600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1567641600,"objectID":"50bcd4fb7979bf942e9f67bb2b1038a2","permalink":"https://www.shulele.net/en/post/20190627_ndvi/","publishdate":"2019-06-27T00:00:00Z","relpermalink":"/en/post/20190627_ndvi/","section":"post","summary":"The normalized difference vegetation index (NDVI) is a simple graphical indicator that reflect the greenness and the heath condition of vegetations.\nThe raw data is from NASA MOD13A.\n The global NDVI variation from 2002 to 2017.     The NDVI varies from 2002 to 2017 in US (Continental)   How to download the rawdata The code of the monthly NDVI from MODIS dataset is MOD13C2, so type the code below in your terminal and the wget will download all availalble data from server to you local matchine.","tags":[],"title":"Monthly NDVI change in USA and Global from 2002-2017","type":"post"},{"authors":["Lele Shu"],"categories":["Research"],"content":" Introduction of HYPERION  The objective of HYPERION is the development of a comprehensive regional hydroclimate data assessment capability focused on feature-specific metrics and stakeholder-relevant outcomes. The secondary objective of this proposal is to leverage this assessment capability to improve our ability to predict these outcomes, by identifying the process-level drivers of outcome biases and evaluating the most appropriate and efficient ways to couple climate models, hydrologic models, and models of human impacts.\nTasks in hydrologic modeling  Develop a hydrologic modeling system for both the Sacramento watershed and several subcatchments. Calculate key hydrological metrics, including stream flow, groundwater table, soil moisture, and snow pack.\u000b Evaluate the quality of the hydrologic model and identify potential issues related to its performance.\u000b Develop a statistical downscaling technique using both traditional statistical and machine learning methods that digests input to the hydrologic model and mimics the output of the model.\u000b Determine which input variables are most relevant for producing an accurate statistical model.     Spatial Data Annual Precipitation          Sacramento Watershed The Sacramento River flows from Southern Oregon and to San Francisco Bay. Total drainage area is ~72000 km2. Elevation ranges from 0 to 4200m. The climate in SW is semi-arid hot Mediterranean. The spatial climatic characteristics are not only affected by latitude, terrain and snow coverage, but also by wind and ocean currents. Dramatic seasonal and annual climatic variations exist as well as large spatial heterogeneity. The mountains on the eastern and northern edges of the domain accumulate rain and snow which funnels into the groundwater of the whole watershed. Annual precipitation ranges from 400 mm/year to 1500 mm/year, however extreme annual precipitation was more than 4000 mm/year in Northern mountainous area in 1983, and mean precipitation was only 270 mm/year from the 2013 extreme drought year.\nAnimation of spatial annual precipitation in Sacramento Watershed     Monthly variation of precipitation in Sacramento Watershed Annual precipitation variation from 1979 to 2017 based on NLDAS data          Simulation and Results The calibration of the PIHM model used the Covariance Matrix Adaptation Evolution Strategy (CMA-ES) (Hansen 2006,Auger 2005). The automatic CMA-ES calibration is robust and able to converge to global optimization with low computing cost.\nRiver discharge The stream flow in the watershed follows the seasonal variation of precipitation. During drought years, the base flow from groundwater depletion contributes to the streamflow, and the excess infiltration replenishes ground water in wet seasons. For small watersheds in the Central Valley, such as catchment #9 where precipitation is less and the aquifer is thicker, the contribution from groundwater is small. Calibration based on discharge of four subcatchments \nGround water variation The ground water near the river channel is shallower than the hill-slope. The spatial distribution pattern of ground water is controlled by topography, soil/geology characteristics and shape of the watershed. Steep slopes store less ground water than moderate slopes, because a steep hydraulic gradient on steep slopes drive the lateral groundwater flow.\n             Ground water spatial distribution Temporal fluctuation from 2000 to 2017.    Ground water seasonal fluctuation follows the climatic variation. However, the seasonal variations in some catchments are relatively larger than others. The inter-annual variation in #5 sub-catchment is larger than seasonal variation. Although the annual precipitation trends in each sub-catchments are comparable, the trend in multiple-year changes of ground water table varies. This requires further analysis on water balance and the memory effect of ground water storage.\n","date":1550956394,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1572912000,"objectID":"d57004782bbac91f799101996134fb02","permalink":"https://www.shulele.net/en/project/hyperion/","publishdate":"2019-02-23T21:13:14Z","relpermalink":"/en/project/hyperion/","section":"project","summary":"Introduction of HYPERION  The objective of HYPERION is the development of a comprehensive regional hydroclimate data assessment capability focused on feature-specific metrics and stakeholder-relevant outcomes. The secondary objective of this proposal is to leverage this assessment capability to improve our ability to predict these outcomes, by identifying the process-level drivers of outcome biases and evaluating the most appropriate and efficient ways to couple climate models, hydrologic models, and models of human impacts.","tags":["Machine Learning","Climate Change","Hydrology","Statistical Downscaling","Groundwater","Landuse change"],"title":"Hydrologic modeling in project HYPERION","type":"project"},{"authors":["Lele Shu"],"categories":[],"content":"I planed to write an R package and submit on CRAN, that can plot the planets orbiting in Solar System, or satellite/moon orbiting around earth. That package must plot the moving planets, the moon, moon phase and satellite in 2D or 3D canvas. In future, it may calculate the orbit based on orbit mechanics.\nMy son loves the song “The wheels on the bus go round and round“, and he has an obsession on planets. He asks mommy play the solar system documentary every night when we ask him to brush his teeth. So I decided to plot the moving planets in solar system for him with the scientific knowledge I know.\n|My son is obsessed by the planets and stars| |:\u0026ndash;| | |\nAnother motivation is from the Chinese lunar exploration, Chang-E 5 landing on far-side of the moon. Lots of people discussed it and were fuddled on the rotation of moon and relation between the earth and the moon.\nFurthermore, I kept thinking the Chinese semi-lunar calendar for many years, I know the founder mental logic and algorithm of the calendar in my mind, but never scratched the equations and numbers in paper yet. This calendar is determined by the moon phase and the position of the earth in orbit. Definitely the solver in papers are more rousted in my brain.\nLet’s see what I got, by now.\n   The idea of the Moon and the Sun are moving around the Earth, when we assume the earth is the center of system. The orbital period of the moon is 27.321 day, but the synodic period is 29.53 day, that because the sun moves 27.321\u0026frasl;365.25 in its sun’s orbit when the moon moves in the moon’s orbit. It requires 2.2 days to let the sun and the moon to face-to-face again.         |The position of the Moon and the Sun in an earth year (365 day). The right legend shows the moon phase in 30 days. The concentric orbits are numbers of the moon periods.| |:\u0026ndash;| | |\n","date":1548720000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1567641600,"objectID":"c3f59fb52292d1d019657a8ad1dd4ffc","permalink":"https://www.shulele.net/en/post/20190129roundandround/","publishdate":"2019-01-29T00:00:00Z","relpermalink":"/en/post/20190129roundandround/","section":"post","summary":"I planed to write an R package and submit on CRAN, that can plot the planets orbiting in Solar System, or satellite/moon orbiting around earth. That package must plot the moving planets, the moon, moon phase and satellite in 2D or 3D canvas. In future, it may calculate the orbit based on orbit mechanics.\nMy son loves the song “The wheels on the bus go round and round“, and he has an obsession on planets.","tags":[],"title":"The project to plot planets/objects in space and orbital movement.","type":"post"},{"authors":["Lele Shu"],"categories":[],"content":" external_link of the project\nMotivation of the project This is fantastic program to teach the local kids and lead them into the discovering sciences.\n| Panoview of the Math\u0026amp;Science classroom.| |:\u0026ndash;| | |\nWeek 03:    Week 03: Jessica is writing students observation and discussion of plants in two different soils (Sperpentine and sandy loam).         Week 05:    Week 05: The growth condition of their beans.            Week 05: One question from students\u0026rsquo; question box. Question: Why are my plants leaves sticky?         ","date":1548720000,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1567641600,"objectID":"c3a3cdae43ff84d2bedfd4f7f81738b3","permalink":"https://www.shulele.net/en/post/20190129kids-ucd/","publishdate":"2019-01-29T00:00:00Z","relpermalink":"/en/post/20190129kids-ucd/","section":"post","summary":"external_link of the project\nMotivation of the project This is fantastic program to teach the local kids and lead them into the discovering sciences.\n| Panoview of the Math\u0026amp;Science classroom.| |:\u0026ndash;| | |\nWeek 03:    Week 03: Jessica is writing students observation and discussion of plants in two different soils (Sperpentine and sandy loam).         Week 05:    Week 05: The growth condition of their beans.","tags":[],"title":"Volunteer for Kids Discovering Science project in California","type":"post"},{"authors":null,"categories":["teaching"],"content":"  \u0026ldquo;We Shape Our Tools, and Thereafter Our Tools Shape Us\u0026rdquo;\n Objective How to convert scientific questions to efficient programming algorithm, including data structue, computational algorithm, data management and parallelization.\nPrerequisite for attendee  Basic programming knowledge, such as C/C++, Java, R, python, Matlab, etc.  Reference Textbooks: None\nUseful sources:\n Yang, Daoqi. C++ and object-oriented numeric computing for scientists and engineers. Springer Science \u0026amp; Business Media, 2000. Kernighan, Brian W., and Dennis M. Ritchie. The C programming language. 2006. Victor Shtern, Core C++ A Software Engineering Approach, Prentice Hall (2000) ISBN: 0130857297 Running Linux, 4th Edition, Welsh, Kaufman, Dalheimer, and Dawson Chapman, Stephen J. JAVA for Engineers and Scientists. Prentice-Hall, Inc., 2003. Cornell, Gary, and Cay Stephen Horstmann. Core Java. SunSoft press, 1996. Ghai, Ajit. \u0026ldquo;Facts and Fallacies of Software Engineering.\u0026rdquo; Software Quality Professional 5.3 (2003): 38. Karniadakis, George Em, George Karniadakis, and Robert M. Kirby II. Parallel scientific computing in C++ and MPI: a seamless approach to parallel algorithms and their implementation. Vol. 2. Cambridge University Press, 2003. Pacheco, Peter. Parallel programming with MPI. Morgan Kaufmann, 1997.  Grading Two projects and 10 homework.\n 60% term project (30% per project) 40% homework (4% each)  Total 100%\nOutline of the course  Introduction The History and Future of Computing Trends in Programming Languages Linux Utilities: vi, emacs, dbx, make, cvs, and IDE\u0026rsquo;s Brief Introduction to Software Engineering C++  Intro Basics Control and Arrays Pointers Structures, Classes, and Objects Operator Overloading Input / Output Templates C++ vs. Java Brief Discussion of Java, C#, and Objective-C  Parallel Computing  MPI OpenMP Threads  Python Conclusions  ","date":1546300800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1546300800,"objectID":"026619315cf3c8bebcb099b01bc75cc6","permalink":"https://www.shulele.net/en/class_programming/","publishdate":"2019-01-01T00:00:00Z","relpermalink":"/en/class_programming/","section":"","summary":"\u0026ldquo;We Shape Our Tools, and Thereafter Our Tools Shape Us\u0026rdquo;\n Objective How to convert scientific questions to efficient programming algorithm, including data structue, computational algorithm, data management and parallelization.\nPrerequisite for attendee  Basic programming knowledge, such as C/C++, Java, R, python, Matlab, etc.  Reference Textbooks: None\nUseful sources:\n Yang, Daoqi. C++ and object-oriented numeric computing for scientists and engineers. Springer Science \u0026amp; Business Media, 2000.","tags":["programming","course"],"title":"Advance programming","type":"page"},{"authors":null,"categories":["teaching"],"content":"  \u0026ldquo;We Shape Our Tools, and Thereafter Our Tools Shape Us\u0026rdquo;\n Objective How to use R/Python and other programming languages to realize spatial-data managment, GIS function, geostatistical, spatial analysis and visualization.\nPrerequisite for attendee  Preliminary knowledge and experience of spatial data -  Reference Grading Two projects and 10 homework. 40% term project (20% per project) 60% homework (6% each) Total 100%\nContent of course  Fundamental knowledge of spatial data and spatial analysis R and Rstudio Data structure Where to find the data Spatial data format and manipulation Spatial data projection Analysis of vector data Statistical and Geostatistical  ","date":1546300800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1546300800,"objectID":"401d4da8782ee1cb4cb82bf4be42d0f8","permalink":"https://www.shulele.net/en/class_geospatialr/0overview/","publishdate":"2019-01-01T00:00:00Z","relpermalink":"/en/class_geospatialr/0overview/","section":"class_GeospatialR","summary":"  \u0026ldquo;We Shape Our Tools, and Thereafter Our Tools Shape Us\u0026rdquo;\n Objective How to use R/Python and other programming languages to realize spatial-data managment, GIS function, geostatistical, spatial analysis and visualization.\nPrerequisite for attendee  Preliminary knowledge and experience of spatial data -  Reference Grading Two projects and 10 homework. 40% term project (20% per project) 60% homework (6% each) Total 100%\nContent of course  Fundamental knowledge of spatial data and spatial analysis R and Rstudio Data structure Where to find the data Spatial data format and manipulation Spatial data projection Analysis of vector data Statistical and Geostatistical  ","tags":["R","GIS","Statistical","Geostatistical","Spatial Analysis","programming","course"],"title":"Geospatial and Geostatistical Analysis with R","type":"class_GeospatialR"},{"authors":["Lele Shu","Paul Ullrich"],"categories":null,"content":"Annual Precipitation (1985-2017) of Sacramento Watershed  Please stop by my poster, we can have a talk.\n","date":1543651200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1543651200,"objectID":"c7484b8e45836dcdcb70288790535c07","permalink":"https://www.shulele.net/en/talk/agu2018/","publishdate":"2018-12-01T00:00:00-08:00","relpermalink":"/en/talk/agu2018/","section":"talk","summary":"Poster in AGU 2018 Fall meeting","tags":["Poster","Hydrologic Modeling","PIHM"],"title":"Model simulated spatial distribution and the variation of ground water level in Sacramento Watershed, California from 1985 to 2017","type":"talk"},{"authors":null,"categories":null,"content":"","date":1527231600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1527231600,"objectID":"379818d05382b0911cb0e786529a5051","permalink":"https://www.shulele.net/en/publication/cobourn2018/","publishdate":"2018-05-25T00:00:00-07:00","relpermalink":"/en/publication/cobourn2018/","section":"publication","summary":"Recent debate over the scope of the U.S. Clean Water Act underscores the need to develop a robust body of scientific work that defines the connectivity between freshwater systems and people. Coupled natural and human systems (CNHS) modeling is one tool that can be used to study the complex, reciprocal linkages between human actions and ecosystem processes. Well-developed CNHS models exist at a conceptual level, but the mapping of these system representations in practice is limited in capturing these feedbacks. This article presents a paired conceptual-empirical methodology for functionally capturing feedbacks between human and natural systems in freshwater lake catchments, from human actions to the ecosystem and from the ecosystem back to human actions. We address extant challenges in CNHS modeling, which arise from differences in disciplinary approach, model structure, and spatiotemporal resolution, to connect a suite of models. In doing so, we create an integrated, multi-disciplinary tool that captures diverse processes that operate at multiple scales, including land-management decision-making, hydrologic-solute transport, aquatic nutrient cycling, and civic engagement. In this article, we build on this novel framework to advance cross-disciplinary dialogue to move CNHS lake-catchment modeling in a systematic direction and, ultimately, provide a foundation for smart decision-making and policy. ","tags":[],"title":"From concept to practice to policy: modeling coupled natural and human systems in lake catchments","type":"publication"},{"authors":["Lele Shu","Christopher Duffy"],"categories":null,"content":"","date":1512115200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1512115200,"objectID":"694393a914f2a208ce9bb336ecbced3c","permalink":"https://www.shulele.net/en/talk/agu2017/","publishdate":"2017-12-01T00:00:00-08:00","relpermalink":"/en/talk/agu2017/","section":"talk","summary":"Poster in AGU 2017 Fall meeting","tags":["Poster","Landuse change","Hydrologic Modeling","PIHM"],"title":"Coupling Cellular Automata Land Use Change with Distributed Hydrologic models","type":"talk"},{"authors":["Lele Shu"],"categories":null,"content":"","date":1502434800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1502434800,"objectID":"30d2cfc3078e3b420ad505b0cdaa25b5","permalink":"https://www.shulele.net/en/publication/shu2017/","publishdate":"2017-08-11T00:00:00-07:00","relpermalink":"/en/publication/shu2017/","section":"publication","summary":"In this study we applied two spatially explicit models to the problem. One is the Penn State Integrated Hydrologic Model (PIHM), a hydrologic model that partitions the water balance in space and time over the urban catchment. The other is the Cellular Automata Land Use Change Model (CALUC), a land use change model, which simulates the evolution of land use classes based on physical measures associated with population change and land use demand factors. We selected two study sites, one modern and one ancient, to highlight the capability of coupling catchment hydrology with land use change models. The goal is to assess the role of hydrologic change in urbanizing watersheds and to evaluate the contemporaneous impacts of climate change. The modern sites are the Conestoga watershed and the Lancaster PA urban center; the historical site is the ancient Maya city of Tikal in Peten region of Guatemala. In each setting, the essential data was developed and the models were used to evaluate how urbanization and land use change gradually altered the entire water balance often in unexpected ways. ","tags":[],"title":"Impacts of Urbanization and Climate Change on the Hydrological Cycle: A Study in Modern and Ancient Land Use Change","type":"publication"},{"authors":["Lele Shu"],"categories":["Research"],"content":" Introduction of project    Location of Tikal   Tasks in hydrologic modeling    Land use map of Tikal      Elevation of Tikal   Accomplishment of the project keep updating\n","date":1469326394,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1572912000,"objectID":"23c40ab383fb046f6e10761dd83cc790","permalink":"https://www.shulele.net/en/project/tikal/","publishdate":"2016-07-23T21:13:14-05:00","relpermalink":"/en/project/tikal/","section":"project","summary":"Introduction of project    Location of Tikal   Tasks in hydrologic modeling    Land use map of Tikal      Elevation of Tikal   Accomplishment of the project keep updating","tags":["PIHM","Maya","Hydrology","Drought","Anthropology","Climate Change","Groundwater","Landuse change"],"title":"Reconstructing the role of landuse change on water yield at the Maya urban","type":"project"},{"authors":null,"categories":null,"content":"MENDOTA\n","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"bc4fb45aa097aac36a42b188b105e6be","permalink":"https://www.shulele.net/en/vis3d/mendota/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/en/vis3d/mendota/","section":"vis3d","summary":"The SHUD modeling in Mendota Lake, Wisconsin","tags":["Lake","SHUD"],"title":"Mendota Lake","type":"vis3d"},{"authors":null,"categories":null,"content":"","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"96525275c000d06f5aae49fa26357ea7","permalink":"https://www.shulele.net/en/vis3d/sunapee/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/en/vis3d/sunapee/","section":"vis3d","summary":"The SHUD modeling in Sunapee Lake, New Hampshire.","tags":["Lake","SHUD"],"title":"Sunapee Lake","type":"vis3d"},{"authors":null,"categories":null,"content":"","date":1461715200,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1461715200,"objectID":"a9ebaa21500c366c0e9db8c6e4629282","permalink":"https://www.shulele.net/en/vis3d/yanhuacun/","publishdate":"2016-04-27T00:00:00Z","relpermalink":"/en/vis3d/yanhuacun/","section":"vis3d","summary":"The mud flood 2018 in Yanhua Village, Ningxia, China","tags":["Lake","SHUD"],"title":"Yanhua Village in Ningxia, China","type":"vis3d"},{"authors":["Lele Shu","Christopher Duffy"],"categories":null,"content":"","date":1448956800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1448956800,"objectID":"5ac2112bfcb9352bd776e46a6ef0d12d","permalink":"https://www.shulele.net/en/talk/agu2015/","publishdate":"2015-12-01T00:00:00-08:00","relpermalink":"/en/talk/agu2015/","section":"talk","summary":"Poster in AGU 2015 Fall meeting","tags":["Poster","Climate Change","Water availability","Hydrologic Modeling","PIHM"],"title":"Catchment hydrological change from soil degradation","type":"talk"},{"authors":["Lele Shu"],"categories":["Research"],"content":" Introduction of project Tasks in hydrologic modeling Accomplishment of the project keep updating\n","date":1437685994,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1572912000,"objectID":"927056f7e44566ab84a58b7007bb3693","permalink":"https://www.shulele.net/en/project/stormwater/","publishdate":"2015-07-23T21:13:14Z","relpermalink":"/en/project/stormwater/","section":"project","summary":"Introduction of project Tasks in hydrologic modeling Accomplishment of the project keep updating","tags":["PIHM","Watershed","Hydrology","Drought","Flood","Climate change","Landuse change"],"title":"Impact in hydrology from landuse and climate change","type":"project"},{"authors":["Lele Shu","Christopher Duffy","Kirk D. French","Timothy Murtha","Susana E. Garcia-gonzalez"],"categories":null,"content":"","date":1420012800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1420012800,"objectID":"53fa3ba945d512d283093e339d5449c9","permalink":"https://www.shulele.net/en/talk/agu2014/","publishdate":"2014-12-31T00:00:00-08:00","relpermalink":"/en/talk/agu2014/","section":"talk","summary":"Poster in AGU 2014 Fall meeting","tags":["Poster","Climate Change","Water availability","Hydrologic Modeling","PIHM","Water budgets"],"title":"Reconstructing the role of landuse change on water yield at the Maya urban center Tikal, Guatemala [700-800 AD]","type":"talk"},{"authors":["Lele Shu","Christopher Duffy"],"categories":null,"content":"","date":1388476800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1388476800,"objectID":"712714a9777e5560c73abaed79a373c2","permalink":"https://www.shulele.net/en/talk/agu2013/","publishdate":"2013-12-31T00:00:00-08:00","relpermalink":"/en/talk/agu2013/","section":"talk","summary":"Talk in AGU 2013 Fall meeting","tags":["Poster","Landuse change","Hydrologic Modeling","PIHM"],"title":"Urbanization-driven hydrological process change in Conestoga River watershed in Lancaster of Pennsylvania","type":"talk"},{"authors":["Nan, Zhuotong","Shu, Lele","Zhao, Yanbo","Li, Xin","Ding, Yongjian"],"categories":null,"content":"","date":1314255600,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":1314255600,"objectID":"2fb95b36d412e4d7cfc298a20ecd8e9d","permalink":"https://www.shulele.net/en/publication/nan2011/","publishdate":"2011-08-25T00:00:00-07:00","relpermalink":"/en/publication/nan2011/","section":"publication","summary":"We designed and implemented an integrated modeling environment (HIME) for hydrological and land surface modeling purpose in a much extendable, efficient and easy use manner. With such design, a physical process was implemented as a module, or component. A new model can be generated in an intuitive way by linking module icons together and establishing their relationships. Following an introduction to the overall architecture, the designs for module linkage and data transfer between modules are described in details. Using XML based meta-information, modules in either source codes or binary form can be utilized by the environment. As a demonstration, with the help of HIME, we replaced the evaporation module of TOPMODEL with the evapotranspiration module from the Noah land surface model which explicitly accounts for vegetation transpiration. This example showed the effectiveness and efficiency of the modeling environment on model integration.","tags":["Noah LSM","TOPMODEL","modeling","environment","the Heihe River Basin"],"title":"Integrated modeling environment and a preliminary application on the Heihe River Basin, China","type":"publication"},{"authors":null,"categories":null,"content":"","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"665288c8761d48eb3366c37954243edc","permalink":"https://www.shulele.net/en/gallery/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/en/gallery/","section":"","summary":"","tags":null,"title":"Gallery","type":"widget_page"},{"authors":null,"categories":null,"content":" Objective The objective to this class is to learn the steps involved in developing mathematical models for applied environmental/water resources problems, and using numerical methods to solve these mathematical models.\nTo become familiar with:\n explicit method, implicit method, Linear/Non-Linear Partial Differential Equations (PDE), and numeric solutions for advection-dispersion equations.  To write or use existing finite element and/or boundary element programs to analyze project scale problems.\u2028Prerequisite for attendee  College calculus and algebra Groundwater hydraulics Basic programming knowledge, such as C/C++, Java, R, python, Matlab, etc.  Reference  Segerlind, L. J. Applied Finite Element Analysis. John Wiley and Sons, Inc., New York, NY (Reserve, Engineering Library). Brebbia, C. A., J. C. F. Telles and L. C. Wrobel. Boundary Element Techniques. Springer Verlag, New York, NY (Reserve, Engineering Library). Brebbia, C. A. and J. Dominguez. Boundary Elements\u0026ndash;An Introductory Course. McGraw Hill, New York, NY (Reserve, Engineering Library). Kane, J. H. Boundary Element Analysis. Prentice Hall, Englewood Cliffs, NJ. Gerald, C. F. and P. O. Wheatley. Applied Numerical Analysis. Addison Wesley, Reading, MA (Reserve, Engineering Library).  Grading Two projects and 10 homeworks. 40% term project (20% per project) 60% homework (6% each) Total 100%\n   Week Class Homework     1 Taylor Series Hand writing the Taylor series, forward/backward/central derivative equations     Euler/Heun/Runge-Kutta methods Write code to compare the error of Euler, Heun and Runge-Kutta equations on two problems    2       class 1  ","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"001b71417487d3d1518fceb32562aef3","permalink":"https://www.shulele.net/en/class_fdm/0overview/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/en/class_fdm/0overview/","section":"class_FDM","summary":"Objective The objective to this class is to learn the steps involved in developing mathematical models for applied environmental/water resources problems, and using numerical methods to solve these mathematical models.\nTo become familiar with:\n explicit method, implicit method, Linear/Non-Linear Partial Differential Equations (PDE), and numeric solutions for advection-dispersion equations.  To write or use existing finite element and/or boundary element programs to analyze project scale problems.\u2028Prerequisite for attendee  College calculus and algebra Groundwater hydraulics Basic programming knowledge, such as C/C++, Java, R, python, Matlab, etc.","tags":null,"title":"Numerical Methods in Hydrology","type":"class_FDM"},{"authors":null,"categories":null,"content":"","date":-62135596800,"expirydate":-62135596800,"kind":"page","lang":"en","lastmod":-62135596800,"objectID":"322dbaccf72a6d71f827fdb2866be935","permalink":"https://www.shulele.net/en/teaching/","publishdate":"0001-01-01T00:00:00Z","relpermalink":"/en/teaching/","section":"","summary":"","tags":null,"title":"Teaching","type":"widget_page"}]